# APP设计文档

## 概述

本文档基于后端API接口设计，为移动应用（Flutter）和Web应用提供完整的功能规划和界面设计方案。涵盖用户认证、文件管理、家族树、活动管理、应用版本、IPTV、消息中心、地图轨迹、TV频道、验证码等10个核心功能模块。

## 系统架构

### 技术栈
- **后端**: Spring Boot + MySQL + Redis
- **移动端**: Flutter (支持iOS/Android)
- **Web端**: Vue.js/React
- **文件存储**: 本地文件系统
- **认证方式**: JWT Token

### 基础信息
- **API基础路径**: `http://localhost:8080`
- **认证方式**: Bearer Token
- **响应格式**: 统一JSON格式

## 功能模块设计

### 1. 用户认证模块

#### 功能清单
- 用户注册（邮箱验证）
- 用户登录（支持验证码）
- 密码重置
- Token刷新
- 用户信息管理

#### 核心API接口
- **注册**: `POST /register`
- **登录**: `POST /login`
- **获取用户信息**: `GET /profile`
- **更新用户信息**: `POST /updateUserInfo`
- **重置密码**: `POST /resetPassword`
- **Token刷新**: `POST /refreshToken`
- **获取验证码**: `GET /captcha?requestId={id}`
- **发送邮箱验证码**: `POST /sendEmailCaptcha`

#### 界面设计

##### 登录页面
┌─────────────────────────────┐
│         应用Logo            │
│                            │
│  ┌───────────────────────┐  │
│  │   邮箱/用户名          │  │
│  └───────────────────────┘  │
│  ┌───────────────────────┐  │
│  │      密码             │  │
│  └───────────────────────┘  │
│  ┌───────────────────────┐  │
│  │   验证码（如需）       │  │
│  └───────────────────────┘  │
│  ┌───────────────────────┐  │
│  │       登录            │  │
│  └───────────────────────┘  │
│                            │
│  忘记密码？    立即注册     │
└─────────────────────────────┘


### 2. 文件管理模块

#### 功能清单
- 文件上传（最大100MB）
- 文件列表（分页，支持搜索）
- 文件下载
- 文件删除
- 文件信息查询

#### 核心API接口
- **文件上传**: `POST /file/upload`
- **文件列表**: `GET /file/list?page={page}&size={size}&keyword={keyword}`
- **文件下载**: `GET /file/download/{fileName}`
- **文件信息**: `GET /file/info/{fileId}`
- **文件删除**: `DELETE /file/delete/{fileId}`

#### 界面设计

##### 文件列表页面
┌─────────────────────────────┐
│ 文件管理          [上传]    │
├─────────────────────────────┤
│ ┌───────────────────────┐    │
│ │ 搜索文件名...        │ 🔍 │
│ └───────────────────────┘    │
├─────────────────────────────┤
│ ┌─────┬─────────┬─────┬────┐ │
│ │文件名│文件大小 │时间 │操作│ │
│ ├─────┼─────────┼─────┼────┤ │
│ │文档1│ 2.5MB   │今天 │[下载]│
│ │图片1│ 1.2MB   │昨天 │[删除]│
│ │视频1│ 15.3MB  │2天前│[下载]│
│ └─────┴─────────┴─────┴────┘ │
├─────────────────────────────┤
│ [←上一页] 第1页/共3页 [下一页→] │
└─────────────────────────────┘


### 3. 家族树模块

#### 功能清单
- 家族成员管理（增删改查）
- 家族关系维护
- 家族树可视化
- 成员搜索（支持关键词）

#### 核心API接口
- **添加成员**: `POST /family/members/add`
- **获取成员**: `GET /family/members/{id}`
- **更新成员**: `PUT /family/members/{id}`
- **删除成员**: `POST /family/members/delete`
- **添加关系**: `POST /family/relationships`
- **获取家族树**: `GET /family/tree/{rootId}?generations={n}`
- **搜索成员**: `GET /family/members/query?keyword={keyword}&page={page}&size={size}`
- **生成模拟数据**: `GET/POST /family/save/mock`

#### 界面设计

##### 家族树页面
┌─────────────────────────────┐
│ 家族树          [添加成员]  │
├─────────────────────────────┤
│ ┌───────────────────────┐    │
│ │ 搜索成员...          │ 🔍 │
│ └───────────────────────┘    │
├─────────────────────────────┤
│        家族树可视化区域      │
│                             │
│     祖父 → 祖母            │
│         ↓                   │
│      父亲 → 母亲            │
│         ↓                   │
│        本人 → 配偶          │
│         ↓                   │
│       子女                 │
├─────────────────────────────┤
│ [←返回]  [放大] [缩小] [导出] │
└─────────────────────────────┘


### 4. 活动管理模块

#### 功能清单
- 活动创建
- 活动列表（分页）
- 活动详情查看
- 模拟数据生成

#### 核心API接口
- **获取活动列表**: `GET /activities?page={page}&size={size}`
- **创建活动**: `POST /activities`
- **生成模拟数据**: `GET/POST /activities/mock`

#### 界面设计

##### 活动列表页面